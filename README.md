



Researcher and collector:
Yunus Lak

Subject:
Extending Biological Simulation Models: Incorporating Complexity and Realism

Research year:
2024





Extending Biological Simulation Models: Incorporating Complexity and Realism

Introduction:
Biological simulation models have become an indispensable tool in the field of ecology and conservation biology. These models allow researchers to simulate various scenarios, predict outcomes, and make informed decisions about conservation efforts. By recreating the complex interactions between species and their environments, biological simulation models provide a unique opportunity to study ecosystem dynamics, identify key drivers of change, and explore the consequences of different management strategies.
However, simple models often lack the complexity and realism needed to accurately capture the intricacies of real-world ecosystems. The omission of critical factors, such as environmental variability, spatial dynamics, and human intervention, can lead to oversimplification and inaccurate predictions. To address these limitations, researchers are increasingly seeking to extend and modify biological simulation models, incorporating additional features and scenarios to enhance their predictive power and applicability.
In this article, we'll delve into the various ways to extend biological simulation models, exploring the benefits and challenges of incorporating additional complexity and realism. We'll discuss the importance of considering multiple species, environmental factors, spatial dynamics, stochasticity, disease models, and human intervention, and how these extensions can improve our understanding of ecosystem dynamics and inform conservation efforts.

Adding More Species:
One of the most straightforward ways to extend a biological simulation model is to introduce additional species to the ecosystem. This can include predators, preys, competitors, or even symbiotic species. By incorporating more species, researchers can study the complex interactions between them, such as:
Predator-prey dynamics:
 Adding a new predator species can reveal how it affects the population dynamics of existing predators and preys. For example, a model that includes a third predator species can show how it competes with existing predators for resources, leading to changes in population sizes and ecosystem stability. This can also lead to the emergence of new predator-prey cycles or even trophic cascades. For instance, the introduction of a new apex predator can lead to a decline in the population of a previously dominant predator, which in turn can affect the population dynamics of its prey species.
Competition for resources:
 Introducing a new competitor species can help researchers understand how it affects the availability of resources, such as food or habitat, and how this impacts population growth and species interactions. This can be particularly important in ecosystems where resources are limited, such as in aquatic or desert environments. For example, a model that includes a new competitor species can show how it affects the growth rates of existing species, leading to changes in population sizes and ecosystem dynamics.


Symbiotic relationships:
 Adding a species that engages in mutualistic or commensal relationships with existing species can reveal how these interactions affect ecosystem dynamics. For instance, a model that includes a species that provides shelter for another species can show how this relationship affects population sizes and ecosystem resilience. This can also lead to the discovery of new symbiotic relationships that were previously unknown. For example, a model that includes a species of coral that provides habitat for a species of fish can show how the health of the coral affects the population dynamics of the fish.
By incorporating more species, researchers can:
Improve model realism:
 Adding more species can increase the model's realism, as it more accurately reflects the complexity of real-world ecosystems. This can be particularly important in ecosystems that are characterized by high biodiversity, such as tropical rainforests or coral reefs. For example, a model that includes multiple species of trees can show how they compete for resources and affect the overall structure of the forest ecosystem.
Enhance predictive power:
 Models that account for multiple species can provide more accurate predictions of ecosystem dynamics and responses to environmental changes. This can be critical in predicting the impacts of climate change, habitat destruction, or invasive species on ecosystem health. For example, a model that includes multiple species of fish can show how changes in water temperature affect their population dynamics and the overall health of the aquatic ecosystem.

Inform conservation efforts:
 By studying the interactions between multiple species, researchers can identify key species that play critical roles in maintaining ecosystem health and inform conservation efforts accordingly. This can include identifying species that are most vulnerable to extinction or those that are most important for maintaining ecosystem resilience. For example, a model that includes multiple species of pollinators can show how changes in their populations affect the reproduction of plant species and the overall health of the ecosystem.
Additionally, incorporating more species can also allow researchers to explore new research questions, such as:
How do changes in one species' population affect the populations of other species in the ecosystem?
How do different species respond to environmental changes, such as changes in temperature or precipitation?
How do species interactions affect ecosystem processes, such as nutrient cycling or decomposition?
How do changes in species interactions affect the overall resilience of the ecosystem?
How do invasive species affect the dynamics of native species and the overall health of the ecosystem?
By exploring these research questions, researchers can gain a deeper understanding of the complex interactions between species in ecosystems and how they respond to environmental changes. This can inform conservation efforts and help policymakers develop more effective strategies for managing and conserving ecosystems.

Incorporating Environmental Factors:
 In addition to incorporating more species, biological simulation models can also be extended to include environmental factors that affect ecosystem dynamics. This can include factors such as:
Climate:
 Temperature, rainfall, and other climate variables can have a significant impact on ecosystem dynamics. For example, changes in temperature can affect the rate at which species grow, while changes in precipitation can affect the availability of water resources. Climate models can be used to simulate the effects of climate change on ecosystem dynamics, such as:
Temperature-dependent growth rates:
 A model that includes temperature-dependent growth rates can show how changes in temperature affect species growth rates and overall ecosystem health.
Phenology:
 A model that includes phenology can show how changes in temperature and precipitation affect the timing of seasonal events such as migration, breeding, and flowering.
Climate-based dispersal:
 A model that includes climate-based dispersal can show how climate change affects the movement and distribution of species.
Soil and Nutrients:
 The availability of nutrients such as nitrogen, phosphorus and potassium can affect the rate of growth of species and the overall health of the ecosystem. Soil models can be used to simulate the effects of nutrient availability on ecosystem dynamics, such as:
Nutrient cycling:
 A model that includes nutrient cycling can show how nutrient availability affects species growth rates and overall ecosystem health.
Soil moisture:
 A model that includes soil moisture can show how changes in soil moisture affect species growth rates and overall ecosystem health.
Light and radiation:
 The amount of light and radiation that species receive can affect their growth rate and behavior. Light models can be used to simulate the effects of light on ecosystem dynamics, such as:
Photosynthesis:
 A model that includes photosynthesis can show how changes in light affect species growth rates and overall ecosystem health.
Shading:
 A model that includes shading can show how changes in light affect species growth rates and overall ecosystem health.
Topographic and landscape features:
 The shape and features of the landscape can affect the movement and behavior of species, as well as the availability of resources such as water and habitat. Landscape models can be used to simulate the effects of topography and landscape features on ecosystem dynamics, such as:


Habitat fragmentation:
 A model that includes habitat fragmentation can show how changes in landscape features affect species movement and behavior.
Water flow:
 A model that includes water flow can show how topographic changes affect access to water resources.
Human activities:
 Human activities such as deforestation, habitat destruction and pollution can have a significant impact on ecosystem dynamics. Human activity models can be used to simulate the effects of human activities on ecosystem dynamics, such as:
Land-use change:
 A model that includes land-use change can show how land-use changes affect species growth rates and overall ecosystem health.
Pollution:
 A model that includes pollution can show how changes in pollution levels affect species growth rates and overall ecosystem health.
By combining environmental factors, researchers can:
Improving model realism: Including environmental factors can increase model realism, as it more accurately reflects the complexity of real-world ecosystems.
Strengthening predictive power:
 Models that consider environmental factors can provide more accurate predictions of ecosystem dynamics and responses to environmental changes.
Conservation efforts:
 By studying the interactions between environmental factors and species, researchers can identify key factors affecting ecosystem health and inform conservation efforts accordingly.
Some examples of how to combine environmental factors in biological simulation models are:
Coupled models:
 Coupled models that combine climate, soil, and landscape models can show how changes in environmental factors affect ecosystem dynamics.
Scenario modeling:
 Scenario modeling can be used to simulate the effects of different environmental scenarios, such as climate change or habitat destruction, on ecosystem dynamics.
Sensitivity analysis:
 Sensitivity analysis can be used to identify the most important environmental factors affecting ecosystem dynamics and prioritize conservation efforts.
By incorporating environmental factors, researchers can gain a deeper understanding of the complex interactions between species and their environment and how these interactions affect ecosystem dynamics. This can contribute to conservation efforts and help policymakers develop more effective strategies for managing and protecting ecosystems.



Implementing Spatial Dynamics:
In addition to incorporating environmental factors, biological simulation models can also be extended to include spatial dynamics, which account for the movement and distribution of species in space. This can include factors such as:
Dispersal:
 The movement of individuals or propagules from one location to another, which can affect the distribution of species and the dynamics of ecosystems. Dispersal can be influenced by various factors, such as:
Distance:
 The distance between habitats or patches of habitat can affect the likelihood of dispersal.
Barriers:
 Physical barriers, such as mountains or rivers, can impede dispersal.
Corridors:
 Habitat corridors can facilitate dispersal by providing a pathway for species to move through.
Migration:
 The seasonal or long-term movement of species from one location to another, which can affect the distribution of species and the dynamics of ecosystems. Migration can be influenced by various factors, such as:
Climate:
 Changes in climate can affect the timing and duration of migration.


Food availability:
 The availability of food resources can affect the migration patterns of species.
Predation:
 The presence of predators can affect the migration patterns of species.
Habitat fragmentation:
 The breaking up of habitats into smaller patches, which can affect the movement and distribution of species. Habitat fragmentation can be influenced by various factors, such as:
Land-use change:
 Changes in land use, such as deforestation or urbanization, can lead to habitat fragmentation.
Infrastructure development:
 The construction of roads, dams, or other infrastructure can lead to habitat fragmentation.
Climate change:
 Changes in climate can affect the distribution and connectivity of habitats.
Landscape connectivity:
 The degree to which habitats are connected, which can affect the movement and distribution of species. Landscape connectivity can be influenced by various factors, such as:
Habitat corridors:
 The presence of habitat corridors can increase landscape connectivity.
Habitat quality:
 The quality of habitats can affect landscape connectivity, with high-quality habitats serving as stepping stones for species movement.
Barrier removal:
 The removal of barriers, such as dams or roads, can increase landscape connectivity.
By incorporating spatial dynamics, researchers can:
Improve model realism:
 Including spatial dynamics can increase the model's realism, as it more accurately reflects the complexity of real-world ecosystems.
Enhance predictive power:
 Models that account for spatial dynamics can provide more accurate predictions of ecosystem dynamics and responses to environmental changes.
Inform conservation efforts:
 By studying the spatial dynamics of species, researchers can identify key areas that require conservation efforts, such as habitat corridors or connectivity restoration.
Some examples of how spatial dynamics can be implemented in biological simulation models include:
Cellular automata:
 A modeling approach that uses a grid of cells to simulate the movement and distribution of species in space. Cellular automata can be used to model the spread of invasive species, the movement of species in response to climate change, or the fragmentation of habitats.
Agent-based models:
 A modeling approach that uses individual agents to simulate the movement and behavior of species in space. Agent-based models can be used to model the migration patterns of species, the dispersal of seeds, or the foraging behavior of animals.
Landscape models:
 A modeling approach that uses spatial data to simulate the movement and distribution of species in response to landscape features and habitat fragmentation. Landscape models can be used to model the connectivity of habitats, the movement of species through corridors, or the effects of land-use change on ecosystem dynamics.
Graph theory:
 A mathematical approach that uses graphs to simulate the connectivity of habitats and the movement of species between them. Graph theory can be used to model the structure of food webs, the movement of species through habitat networks, or the effects of habitat fragmentation on ecosystem dynamics.
Some examples of spatial dynamics in biological simulation models include:
Metapopulation models:
 Models that simulate the movement and distribution of species between patches of habitat. Metapopulation models can be used to study the dynamics of species in fragmented landscapes, the effects of habitat destruction on population viability, or the role of corridors in maintaining connectivity.


Source-sink models:
 Models that simulate the movement of species from high-quality habitats (sources) to low-quality habitats (sinks). Source-sink models can be used to study the dynamics of species in heterogeneous landscapes, the effects of habitat degradation on population viability, or the role of corridors in maintaining connectivity.
Landscape genetics:
 Models that simulate the movement and distribution of genes in response to landscape features and habitat fragmentation. Landscape genetics can be used to study the effects of habitat fragmentation on genetic diversity, the role of corridors in maintaining genetic connectivity, or the dynamics of species in response to climate change.












Introducing Stochasticity:
 Random events and uncertainties are inherent in natural systems. By incorporating stochasticity into the model, researchers can study how random fluctuations affect ecosystem dynamics and population stability. This can include random weather events, stochastic disease transmission, or other sources of uncertainty.
There are several types of stochasticity that can be incorporated into biological simulation models, including:
Environmental stochasticity:
 Random fluctuations in environmental factors, such as temperature, precipitation, or resource availability, can affect the dynamics of ecosystems. Environmental stochasticity can be modeled using stochastic differential equations or Markov chain models.
Demographic stochasticity:
 Random events, such as birth, death, or migration, can affect the population dynamics of species. Demographic stochasticity can be modeled using individual-based models or Monte Carlo simulations.
Genetic stochasticity:
 Random changes in gene frequencies can affect the evolution of species. Genetic stochasticity can be modeled using evolutionary models or genetic algorithms.
Observation stochasticity:
 Random errors in data collection or measurement can affect the accuracy of model predictions. Observation stochasticity can be modeled using Bayesian statistics or uncertainty analysis.

Methods for Incorporating Stochasticity:
There are several methods for incorporating stochasticity into biological simulation models, including:
Stochastic differential equations:
 A mathematical approach that uses stochastic differential equations to model the dynamics of ecosystems in the presence of environmental variability.
Markov chain models:
 A modeling approach that uses Markov chains to simulate the random transitions between different states in ecosystems.
Individual-based models:
 A modeling approach that uses individual-based models to simulate the demographic stochasticity of species populations.
Monte Carlo simulations: A computational approach that uses Monte Carlo simulations to model the effects of stochasticity on ecosystem dynamics.
Bayesian statistics:
 A statistical approach that uses Bayesian statistics to model the uncertainty and variability of ecosystem dynamics.
Uncertainty analysis: A method that uses uncertainty analysis to quantify the uncertainty and variability of model predictions.




Advantages of Incorporating Stochasticity:
Incorporating stochasticity into biological simulation models can have several advantages, including:
Improved model realism:
 Including stochasticity can increase the model's realism, as it more accurately reflects the uncertainty and variability of real-world ecosystems.
Enhanced predictive power:
 Models that account for stochasticity can provide more accurate predictions of ecosystem dynamics and responses to environmental changes.
Increased flexibility:
 Stochastic models can be used to simulate a wide range of scenarios and outcomes, allowing for more flexible and adaptive management strategies.
Better decision-making:
 By accounting for uncertainty and variability, stochastic models can provide more informed decision-making and policy development.
Challenges of Incorporating Stochasticity:
Incorporating stochasticity into biological simulation models can also present several challenges, including:
Increased complexity:
 Stochastic models can be more complex and difficult to parameterize than deterministic models.

Computational intensity:
 Stochastic models can require significant computational resources and time to run.
Interpretation of results:
 Stochastic models can produce a wide range of outcomes, making it challenging to interpret and communicate results.
Data requirements: Stochastic models often require large amounts of data to parameterize and validate, which can be challenging to obtain.















Exploring Different Disease Models:
 Disease transmission models are critical components of biological simulation models. By replacing simple disease transmission models with more complex models, such as SIR or SEIR models, researchers can study how disease dynamics affect population growth and ecosystem stability.
Deterministic Models:
Deterministic models are based on ordinary differential equations (ODEs) and assume that the disease dynamics are predictable and follow a fixed pattern. These models are useful for understanding the general behavior of disease outbreaks and can be used to estimate key epidemiological parameters, such as the basic reproduction number (R0). However, deterministic models do not account for the inherent uncertainty and variability of real-world systems.
Advantages of Deterministic Models:
Easy to implement:
 Deterministic models are relatively simple to implement and require minimal computational resources.
Fast computation:
 Deterministic models can be solved quickly, making them useful for rapid decision-making.
Easy to interpret:
 The results of deterministic models are easy to interpret, as they provide a clear and deterministic outcome.


Limitations of Deterministic Models:
Lack of realism:
 Deterministic models do not account for the uncertainty and variability of real-world systems, making them less realistic.
Oversimplification:
 Deterministic models often oversimplify the complexity of real-world systems, leading to inaccurate predictions.
Stochastic Models:
Stochastic models, on the other hand, incorporate randomness and uncertainty into the disease dynamics. These models can be based on stochastic differential equations (SDEs), Markov chains, or Monte Carlo simulations. Stochastic models are more realistic than deterministic models, as they account for the unpredictability of real-world systems.
Advantages of Stochastic Models:
More realistic:
 Stochastic models are more realistic, as they account for the uncertainty and variability of real-world systems.
Better prediction:
 Stochastic models can provide more accurate predictions, as they account for the randomness and uncertainty of real-world systems.
Flexibility:
 Stochastic models can be used to simulate a wide range of scenarios and outcomes, making them useful for exploring different disease control strategies.

Limitations of Stochastic Models:
Computational intensity:
 Stochastic models can require significant computational resources and time to run.
Interpretation of results:
 Stochastic models can produce a wide range of outcomes, making it challenging to interpret and communicate results.
Data requirements:
 Stochastic models often require large amounts of data to parameterize and validate, which can be challenging to obtain.
Compartmental Models:
Compartmental models divide the population into distinct compartments, such as susceptible, infected, and recovered individuals. These models are useful for understanding the flow of individuals between different disease states and can be used to estimate key epidemiological parameters, such as the basic reproduction number (R0).
Advantages of Compartmental Models:
Easy to implement:
 Compartmental models are relatively simple to implement and require minimal computational resources.
Easy to interpret:
 The results of compartmental models are easy to interpret, as they provide a clear and intuitive understanding of the disease dynamics.

Wide applicability:
 Compartmental models can be applied to a wide range of diseases and scenarios.
Limitations of Compartmental Models:
Oversimplification:
 Compartmental models often oversimplify the complexity of real-world systems, leading to inaccurate predictions.
Lack of realism:
 Compartmental models do not account for the uncertainty and variability of real-world systems, making them less realistic.













Adding Human Intervention:
 Human activities, such as conservation efforts, hunting, or habitat destruction, significantly impact ecosystem dynamics. By incorporating human intervention into the model, researchers can study how these activities affect population growth, species interactions, and ecosystem resilience.
In addition to the basic methods of incorporating human intervention into disease models, there are several advanced topics that can be explored. These include:
Optimal Control Theory:
 Optimal control theory is a mathematical framework for determining the optimal control strategy for a given system. In the context of disease modeling, optimal control theory can be used to determine the optimal vaccination or treatment strategy that minimizes the number of infections while minimizing costs.
Game Theory:
 Game theory is a mathematical framework for analyzing strategic decision-making. In the context of disease modeling, game theory can be used to analyze the interactions between individuals and their decisions to vaccinate or engage in social distancing.
Network Analysis:
 Network analysis is a mathematical framework for analyzing complex networks. In the context of disease modeling, network analysis can be used to analyze the contact network between individuals and how it influences disease transmission.


Machine Learning:
 Machine learning is a branch of artificial intelligence that deals with the development of algorithms that can learn from data. In the context of disease modeling, machine learning can be used to develop predictive models of disease transmission that incorporate human intervention.
Challenges in Incorporating Human Intervention:
Despite the advantages of incorporating human intervention into disease models, there are several challenges that must be addressed. These include:
Behavioral Heterogeneity:
 Individuals differ in their behavior and response to human intervention. This heterogeneity can be difficult to incorporate into disease models, leading to inaccurate predictions.
Data Availability:
 Incorporating human intervention into disease models often requires data on human behavior and intervention effectiveness. However, such data can be difficult to obtain, particularly in low-resource settings.
Model Complexity:
 Incorporating human intervention can increase the complexity of disease models, making them more difficult to interpret and analyze. This complexity can lead to challenges in model validation and selection.
Policy Implications:
 Incorporating human intervention into disease models can have significant policy implications. However, there can be a disconnect between the model predictions and the policy decisions, leading to challenges in implementing effective disease control strategies.




















Conclusion:
 Biological simulation models are powerful tools for understanding ecosystem dynamics and predicting the outcomes of different scenarios. By extending these models to incorporate additional features and scenarios, researchers can enhance their predictive power and applicability. The extensions discussed in this article, including adding more species, incorporating environmental factors, implementing spatial dynamics, introducing stochasticity, exploring different disease models, and adding human intervention, can help create more realistic and informative models. These advances can ultimately inform conservation efforts, management strategies, and policy decisions, leading to a better understanding and protection of our planet's ecosystems.
As we continue to develop and refine disease models that incorporate human intervention, there are several future directions that hold promise for advancing our understanding of infectious diseases and improving disease control strategies.
1. Integration of Multi-Scale Data:
One of the major challenges in incorporating human intervention into disease models is the integration of data from different scales, such as individual-level data, community-level data, and population-level data. Future research should focus on developing methods to integrate these different scales of data to provide a more comprehensive understanding of disease transmission and the impact of human intervention.
2. Incorporating Real-Time Data:
Disease models that incorporate real-time data on human behavior and intervention can provide more accurate predictions and more effective disease control strategies. Future research should focus on developing methods to incorporate real-time data from sources such as social media, mobile devices, and electronic health records.
3. Personalized Disease Models:
Personalized disease models that take into account individual-level characteristics, such as age, health status, and behavior, can provide more accurate predictions and more effective disease control strategies. Future research should focus on developing methods to incorporate individual-level data into disease models.
4. Multi-Disease Models:
Many diseases interact with each other and with human behavior in complex ways. Future research should focus on developing multi-disease models that take into account the interactions between different diseases and the impact of human intervention on these interactions.
5. Incorporating Economic and Social Factors:
Disease models that incorporate economic and social factors, such as poverty, education, and social networks, can provide a more comprehensive understanding of disease transmission and the impact of human intervention. Future research should focus on developing methods to incorporate these factors into disease models.
6. Development of Open-Source Disease Modeling Platforms:
Open-source disease modeling platforms can facilitate collaboration and sharing of models, data, and results among researchers and policymakers. Future research should focus on developing open-source platforms that can be used to develop and refine disease models that incorporate human intervention.

7. Validation and Verification of Disease Models:
Validation and verification of disease models are critical steps in ensuring that the models are accurate and reliable. Future research should focus on developing methods to validate and verify disease models that incorporate human intervention.
8. Development of Decision-Support Systems:
Decision-support systems that incorporate disease models and human intervention can provide policymakers with the tools they need to make informed decisions about disease control strategies. Future research should focus on developing decision-support systems that can be used in real-world settings.
By exploring these future directions, we can continue to advance our understanding of infectious diseases and develop more effective disease control strategies that take into account the complex interactions between human behavior and disease transmission.
The complete code for this theory is as follows:
In this code, we have provided a model for this theory with the help of Python programming language and machine learning.
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

class BiologicalSimulation:
    def __init__(self, initial_preys, initial_predators, time_steps=100, disease_transmission_rate=0.001, predation_rate=0.01, weather_amplitude=0.05, weather_frequency=0.1):
        self.initial_preys = initial_preys
        self.initial_predators = initial_predators
        self.time_steps = time_steps
        self.disease_transmission_rate = disease_transmission_rate
        self.predation_rate = predation_rate
        self.weather_amplitude = weather_amplitude
        self.weather_frequency = weather_frequency
        
        if self.initial_preys < 0 or self.initial_predators < 0:
            raise ValueError("Initial population sizes cannot be negative")

    def run_simulation(self):
        # Simulation parameters
        growth_rate_preys = 0.1
        death_rate_predators = 0.05
        
        # Initialize arrays to hold population data
        prey_data = np.zeros((self.time_steps, 2))
        prey_data[:, 0] = np.arange(self.time_steps)  # Time steps
        prey_data[:, 1] = self.initial_preys  # Initialize prey population
        
        predator_data = np.zeros((self.time_steps, 2))
        predator_data[:, 0] = np.arange(self.time_steps)  # Time steps
        predator_data[:, 1] = self.initial_predators  # Initialize predator population
        
        infected_preys = np.zeros(self.time_steps)  # Initialize infected prey population
        infected_preys[0] = 10  # Initialize with 10 infected individuals
        
        # Simulation loop
        for i in range(1, self.time_steps):
            # Calculate weather factor
            weather_factor = 1 + self.weather_amplitude * np.sin(self.weather_frequency * i)
            
            # Adjust growth rate and predation rate based on weather
            growth_rate_preys_effective = growth_rate_preys * weather_factor
            predation_rate_effective = self.predation_rate * (1 - weather_factor)
            
            # Calculate disease transmission and mortality
            disease_transmission = self.disease_transmission_rate * infected_preys[i-1] * prey_data[i-1, 1]
            disease_mortality = 0.05 * infected_preys[i-1]
            
            # Update population sizes
            prey_data[i, 1] = max(0, prey_data[i-1, 1] * (1 + growth_rate_preys_effective * (1 - prey_data[i-1, 1] / 500) - predation_rate_effective * predator_data[i-1, 1] - disease_mortality))
            prey_data[i, 1] = min(500, max(0, prey_data[i-1, 1] * (1 + growth_rate_preys_effective * (1 - prey_data[i-1, 1] / 500) - predation_rate_effective * predator_data[i-1, 1] - disease_mortality)))

            infected_preys[i] = infected_preys[i-1] + disease_transmission - disease_mortality
            predator_data[i, 1] = max(0, predator_data[i-1, 1] * (1 - death_rate_predators + 0.005 * prey_data[i-1, 1] * predator_data[i-1, 1]))
            predator_data[i, 1] = min(200, max(0, predator_data[i-1, 1] * (1 - death_rate_predators + 0.005 * prey_data[i-1, 1] * predator_data[i-1, 1])))

        
        return prey_data, predator_data, infected_preys

    def visualize_results(self, prey_data, predator_data, infected_preys):
        df_preys = pd.DataFrame(prey_data, columns=['Time', 'Preys'])
        df_predators = pd.DataFrame(predator_data, columns=['Time', 'Predators'])
        df_infected = pd.DataFrame({'Time': np.arange(self.time_steps), 'Infected Preys': infected_preys})
        
        plt.plot(df_preys['Time'], df_preys['Preys'], label='Preys')
        plt.plot(df_predators['Time'], df_predators['Predators'], label='Predators')
        plt.plot(df_infected['Time'], df_infected['Infected Preys'], label='Infected Preys')
        plt.xlabel('Time')
        plt.ylabel('Population Size')
        plt.title('Population Growth Over Time with Disease, Predation, and Weather Changes')
        plt.legend()
        plt.show()

# Example usage
simulation = BiologicalSimulation(
    initial_preys=100,
    initial_predators=20,
    time_steps=200,
    disease_transmission_rate=0.005,
    predation_rate=0.02,
    weather_amplitude=0.1,
    weather_frequency=0.2
)
prey_data, predator_data, infected_preys = simulation.run_simulation()
simulation.visualize_results(prey_data, predator_data, infected_preys)

